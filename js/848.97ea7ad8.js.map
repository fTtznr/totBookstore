{"version":3,"file":"js/848.97ea7ad8.js","mappings":"8IAEO,MAAMA,GAAYC,EAAAA,EAAAA,IAAY,OAAQ,CAEzCC,MAAO,KAEI,CAEHC,MAAO,KAMfC,QAAQ,CAEJC,QAAQC,GAGJ,GAAGC,KAAKJ,MAAM,CAEV,IAAIK,GAAS,EAEb,IAAI,IAAIC,KAAQF,KAAKJ,MAEjB,GAAGM,EAAKC,KAAOJ,EAAKI,GACpB,CAEID,EAAKE,MAAQ,EACbH,GAAS,EACT,KAEJ,CAIAA,IAEAF,EAAKK,KAAO,EACZJ,KAAKJ,MAAMS,KAAKN,GAGxB,MAEIA,EAAKK,KAAO,EACZJ,KAAKJ,MAAQ,CAACG,EAGtB,EAEAO,WAAWP,GAEP,IAAIQ,GAAS,EAEb,IAAI,MAAOC,EAAGN,KAASF,KAAKJ,MAAMa,UAG9B,GAAGP,EAAKC,KAAOJ,EAAKI,GACpB,CAEII,EAAQC,EACR,KAEJ,CAIJ,OAAOD,CAEX,EAEAG,WAAWX,GAEP,IAAIQ,EAAQP,KAAKM,WAAWP,IAEf,GAAVQ,GAAaP,KAAKJ,MAAMe,OAAOJ,EAAO,EAE7C,EAEAK,SAASb,GAEL,IAAIG,EAAOF,KAAKJ,MAAMI,KAAKM,WAAWP,IAEnCG,EAAKE,KAAOF,EAAKW,UAAWX,EAAKE,MAExC,EAEAU,SAASf,GAEL,IAAIG,EAAOF,KAAKJ,MAAMI,KAAKM,WAAWP,IAEnCG,EAAKE,KAAO,GAAGF,EAAKE,MAE3B,EAEAW,eAAeC,GAEX,IAEI,IAAIC,EAAQ,GAEZ,IAAI,IAAIf,KAAQF,KAAKJ,MAEjBqB,EAAMZ,KACN,CACIN,KAAMG,EAAKC,GACXC,KAAMF,EAAKE,OAMnB,MAAMc,EAAO,CAETtB,MAAOqB,EACPE,KAAMH,EACNI,MAAM,IAAIC,MAAOC,UAIrBC,QAAQC,IAAIN,GAEZ,MAAMO,EAAWC,KAAKC,UAAUT,GAE1BU,QAAYC,MAAM,+BAAgC,CAEpDC,OAAQ,OACRC,QAAS,CAAC,eAAgB,oBAC1BC,KAAMP,UAGQG,EAAIK,OAEtBjC,KAAKJ,MAAQ,EAEA,CAAf,MAAOsC,GAAQ,CAErB,GAIJC,QAAS,CAELC,aAEI,IAAIC,EAAQ,EAEZ,GAAGrC,KAAKJ,MAGJ,IAAI,IAAIM,KAAQF,KAAKJ,MAAOyC,GAASnC,EAAKE,KAAOF,EAAKoC,MAI1D,OAAOD,CAEX,I,oEC1JClC,GAAG,S,GAENoC,EAAAA,EAAAA,GAA0B,UAAtB,qBAAiB,G,GAErBA,EAAAA,EAAAA,GAEI,SAFD,4CAEH,G,GAJAC,EAEAC,G,0CAJFC,EAAAA,EAAAA,IAQM,MARNC,EAQM,E,gCAUN,SAEIC,WAEIC,EAAAA,EAAAA,KAAYC,gBAAerD,EAAAA,EAAAA,KAAYG,QACvCH,EAAAA,EAAAA,KAAYsD,UAASC,EAAAA,EAAAA,KAAe7B,KAAKhB,KACzC6C,EAAAA,EAAAA,KAAeD,UAAW,CAE9B,G,aCvBR,MAAME,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,G","sources":["webpack://totbookstore/./src/store/cart.js","webpack://totbookstore/./src/views/CheckoutView.vue","webpack://totbookstore/./src/views/CheckoutView.vue?d317"],"sourcesContent":["import { defineStore } from \"pinia\"\r\n\r\nexport const cartStore = defineStore(\"cart\", {\r\n\r\n    state: () => {\r\n\r\n        return {\r\n\r\n            items: []\r\n\r\n        }\r\n\r\n    },\r\n\r\n    actions:{\r\n\r\n        addCart(book)\r\n        {\r\n\r\n            if(this.items){\r\n\r\n                let inCart = false\r\n\r\n                for(let item of this.items)\r\n                {\r\n                    if(item.id === book.id) \r\n                    {\r\n\r\n                        item.qtde += 1\r\n                        inCart = true\r\n                        break\r\n                    \r\n                    }\r\n\r\n                }\r\n\r\n                if(!inCart) \r\n                {\r\n                    book.qtde = 1\r\n                    this.items.push(book)\r\n                }\r\n\r\n            }else{\r\n\r\n                book.qtde = 1\r\n                this.items = [book]\r\n            }\r\n\r\n        },\r\n\r\n        searchCart(book){\r\n\r\n            let index = -1\r\n            \r\n            for(const [i, item] of this.items.entries())\r\n            {\r\n\r\n                if(item.id === book.id) \r\n                {\r\n\r\n                    index = i\r\n                    break\r\n                \r\n                }\r\n\r\n            }\r\n\r\n            return index\r\n\r\n        },\r\n\r\n        removeItem(book){\r\n\r\n            let index = this.searchCart(book)\r\n\r\n            if(index != -1) this.items.splice(index, 1)\r\n\r\n        },\r\n\r\n        increase(book){\r\n\r\n            let item = this.items[this.searchCart(book)] \r\n\r\n            if(item.qtde < item.quantity ) item.qtde++\r\n\r\n        },\r\n\r\n        decrease(book){\r\n\r\n            let item = this.items[this.searchCart(book)] \r\n \r\n            if(item.qtde > 1) item.qtde--\r\n              \r\n        },\r\n\r\n        async checkout(userID) {\r\n\r\n            try {\r\n\r\n                let books = []\r\n\r\n                for(let item of this.items) {\r\n\r\n                    books.push(\r\n                    {\r\n                        book: item.id,\r\n                        qtde: item.qtde\r\n    \r\n                    })\r\n\r\n                }\r\n                \r\n                const data = {\r\n\r\n                    items: books,\r\n                    user: userID,\r\n                    date: new Date().toJSON()\r\n    \r\n                }\r\n\r\n                console.log(data)\r\n    \r\n                const dataJSON = JSON.stringify(data)\r\n    \r\n                const req = await fetch(\"http://localhost:3000/orders\", {\r\n    \r\n                    method: \"POST\",\r\n                    headers: {\"Content-Type\": \"application/json\"},\r\n                    body: dataJSON\r\n                })\r\n    \r\n                const res = await req.json()\r\n                \r\n                this.items = []\r\n                \r\n            } catch (error) {}\r\n\r\n        }\r\n\r\n    },\r\n\r\n    getters: {\r\n\r\n        totalPrice(){\r\n\r\n            let total = 0\r\n\r\n            if(this.items)\r\n            {\r\n\r\n                for(let item of this.items) total += item.qtde * item.price\r\n\r\n            }\r\n\r\n            return total\r\n\r\n        }\r\n\r\n    }\r\n\r\n})","<template>\r\n\r\n    <div id=\"about\">\r\n  \r\n      <h2>Pedido Realizado!</h2>\r\n  \r\n      <p>\r\n        Obrigado por comprar na Tot Bookstore.\r\n      </p>\r\n  \r\n    </div>\r\n    \r\n  </template>\r\n  \r\n  <script>\r\n  \r\n    import { cartStore } from '@/store/cart'\r\n    import { sessionStore } from '@/store/session'\r\n    import { bookStore } from '@/store/books'\r\n  \r\n    export default {\r\n    \r\n        mounted(){\r\n\r\n            bookStore().changeQuantity(cartStore().items)\r\n            cartStore().checkout(sessionStore().user.id)\r\n            sessionStore().checkout = false\r\n    \r\n        }\r\n  \r\n  }\r\n  \r\n  </script>","import { render } from \"./CheckoutView.vue?vue&type=template&id=4d170f30\"\nimport script from \"./CheckoutView.vue?vue&type=script&lang=js\"\nexport * from \"./CheckoutView.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/felipe/Desktop/totBookstore/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["cartStore","defineStore","state","items","actions","addCart","book","this","inCart","item","id","qtde","push","searchCart","index","i","entries","removeItem","splice","increase","quantity","decrease","async","userID","books","data","user","date","Date","toJSON","console","log","dataJSON","JSON","stringify","req","fetch","method","headers","body","json","error","getters","totalPrice","total","price","_createElementVNode","_hoisted_2","_hoisted_3","_createElementBlock","_hoisted_1","mounted","bookStore","changeQuantity","checkout","sessionStore","__exports__","render"],"sourceRoot":""}